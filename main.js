const Materialien = {
    notwendig: {
        Ausrufe: [
            "拼搏吧！",
            "我为你们呐喊！",
            "你们是最棒的！",
            "我们为你欢呼跳跃，我们为你骄傲！",
            "让我们拭目以待，让我们呐喊助威！",
            "让这激动人心的时刻，一直回荡在我们心中！",
            "面对星辰大海的征程，拼搏吧！",
            "胜利就在眼前！",
            "胜利在向你们招手，向你们呼喊！",
            "我们将为你永远喝彩！",
            "我们为你呐喊，我们为你自豪，我们为你疯狂！",
            "成功属于你们！",
            "快去击败困难、快去夺取胜利！",
            "相信自己，你将赢得胜利，创造奇迹！",
            "相信自己，梦想在你手中，这是你的天地！",
            "是时候表演真正的技术了！",
            "胜利在向你微笑！",
        ],
        Subjekt: [
            "加油吧，{class_}的{event}健儿们！",
            "加油，{class_}的{event}选手{name}！",
            "加油吧，{class_}的健儿们！",
            "加油吧，{event}选手们！",
            "加油，{event}选手{name}！",
            "加油吧，{name}！",
            "加油！",
            "尽情挥洒你的汗水与热血吧，{name}！",
            "你是{class_}的骄傲，你是{class_}的希望！",
            "{name}，你是{class_}的骄傲，你是{class_}的希望！",
            "昨天你们以{class_}为荣耀，今天{class_}因你们而自豪！",
        ]
    },
    unnotwendig: {
        Ihr: [
            "在我们心中，你是一个神话",
            "萧瑟的秋风，挡不住你们破竹的锐气",
            "时代的强音正在你的脚下踏响",
            "热血在沸腾，辉煌在你脚下铸就",
            "成功正在终点冲着你高高地招手",
            "用你的实力，用你的精神，去开拓出一片属于你的天地",
            "你是跑道上划过的流星，燃烧自己，洒下光辉",
            "也许你并没有看到成功像你挥手，但你已奋斗拼搏过，相信自己，力量就在心中",
            "努力拼搏，顽强奋斗，即使落后，也顽强不屈，永不退缩",
            "漫漫的长路上，你独挡一面；运动场上，你是颗冲刺的流星",
            "看台上，千百只眼睛充满希望的望着你",
            "面对漫漫的征途，你没有畏惧和退缩。任汗水打湿脊背，任疲惫爬满全身，依然奋力追赶",
            "你有着不撞南墙不回头、撞破南墙继续冲的拼搏精神，有着不到黄河心不死、跳了黄河继续游的顽强毅力",
            "你们像初升的红日，光芒照耀大地",
            "你们像从深渊飞出的神龙，张牙舞爪",
            "你们像咆哮山林的猛虎，让森林万兽惊慌失措",
            "时间在流逝，赛道在延伸，热血在沸腾，辉煌在你们脚下铸就",
            "你们不畏强敌，展示了自己，就是最勇敢最有魄力的！",
            "不要怕失败，不要怕冷落，无论何时，我们以你为荣",
            "你们拼搏，为美丽的目标；你们奋斗，为班级的辉煌",
            "你们的汗水挥洒在跑道上，浇灌成功花朵的开放",
            "也许你们没有显赫的成绩，但运动场上留下了你们的足迹；也许你们没有奖品，但我们心中留下了你们拼搏的身影",
            "海燕在大海上翱翔，雄鹰搏击长空，你奔驰在赛场上",
            "相信今天你们在红色跑道上迈出的那一步步，将会成为你们将来的花路上的一道靓丽风景线",
            "你们比任何的人都值得去迎接赛道终点的掌声",
            "你们的实力就是你的利剑，你们的信心就是你的盾牌，到终点的那一刻，就是你登峰造极的那一刻",
            "你们的汗水洒在跑道，浇灌着成功的花朵开放",
            "用坚定的脚步去拼搏，用如雨的汗水去见证，用激情的速度去追逐，在长长的跑道书写属于你们的青春画卷",
            "你目光遥长，乘奔御风，向远方迈进，灵魂尚在远航，苦楚终将离去，英勇已经赶赴",
            "激起昂扬的斗志，向着前方的终点，冲吧！",
            "你们快如离弦之箭；疾似奔腾骏马；你们的速度让我们惊叹；你们的精神让我们钦佩",
            "你们有着大浪拍岸的豪迈，你们有着春日阳光的明媚，你们是寒冷冬日里的温暖，让大家的心随你们燃了起来",
            "赛场上的拼搏是你们的浪漫，我相信阳光会为你们加冕",
            "你的呼吸 ， 带着脉搏心跳的频率，随着秋日暖阳呼啸而来，掀起一阵骤风，像是必胜的信念，像是斗志的昂扬。",
        ],
        SchöneSätze: [
            "用青春和热血来铺洒红色的跑道，用激情点燃胜利的曙光",
            "你是运动场的心脏，跳动梦想；你是漫长路的精神，激励辉煌",
            "也许流星并不少见，但它燃烧的刹那，留给人间最美丽的回忆！也许笑脸并不少见，但胜利的喜悦，总会留给世界精彩的一瞬！",
            "枪响的那一刹那，似流星、似闪电，如骏马奔腾，如蛟龙腾空，如猛虎出洞，不在乎名次高低，不在乎成绩高下",
            "你听那激烈奔跑的脚步声，震撼大地；你听那欢呼加油的呐喊声，催人奋进；你听那热血沸腾的心跳声，燃烧激情",
            "赛场上的旋律，如旋风般急速，如号角般激扬，如激流般奔腾不息",
            "没有比脚更长的路，没有比人更高的山",
            "跑归跑，跳归跳，谁好谁坏谁知道？哭归哭，笑归笑，比赛输赢不重要",
            "有困难才能看透谁薄谁厚，有较量才能发现谁先谁后",
            "这耐力的战争，坚持下来就是赢家；这毅力的比赛，坚持下来就是强者",
            "人不是为了失败而生，但也不是为了成功而存活",
            "花儿准备了春秋冬，就是为了红透整个盛夏。雪花经历了春夏秋，就是为了洁白整个严冬",
            "不为鲜花的围绕，不为刹那的荣耀，仅有执着的信念，化作不停的奔跑，心中燃烧着梦想，脚下不停的步伐",
            "每一份辛劳都有一份收获，每一次的痛苦都是欢乐的开始，每一声呐喊都是力量的呼唤",
            "Where there is a will, there is a way！",
            "一旦踏上征途，便不再回头，不去想是否能够成功，不去看昨日有多艰辛，只顾风雨兼程，为了冲过终点那瞬间的耀眼，义无反顾。",
            "大鹏展翅传扶摇而上九万里青天，鲤鱼打挺逆洋流而上飞跃战龙门",
            "汗流千日，只为今日一搏；疾踏百步，只为终点一触",
        ],
        DetaillierteBeschreibung: [
            "晨风轻轻地唤醒骄阳",
            "校园的操场传来发令枪的声响",
            "湿透的衣衫，满头的大汗，无限追求奋力追赶",
            "你们的欢笑飞扬在赛场",
            "环形的跑道，一圈又一圈的坚持，毅力与精神活跃在会场上",
            "湿透的衣衫，满头的大汗，无限追求奋力追赶",
            "运动场上彩旗飘，运动健儿显英豪",
            "广阔的绿茵场，是为你们搭建的舞台",
            "左手遮不住汗水，右手遮不住太阳",
            "看那坚毅的身躯，是体育场上游走的火焰；看那轻盈的飞跃，是太阳折射出的金色光芒",
            "听那清脆的枪声响彻天际；听那呐喊与掌声混合的交响乐。它们粲然升起那跃动的渴望",
            "热血在赛场沸腾，巨人在赛场升起",
            "红色的跑道因有了你的身影而更加夺目，绿色的草坪因挥洒过你的汗水而更加葱郁",
        ]
    }
};

const Punkt = "。";

const Länge = (...args) => args.reduce((sum, arg) => sum + (arg instanceof Array ? Länge(...arg) : arg.length)
    , 0);

const durchmischen = (arr) => arr.sort(() => 0.5 - Math.random());

/// Example: '{age} Jahres alt', {'age': 18} -> '18 Jahres alt'
function VorlageAusfüllen(text, dict) {
    if (!dict) {
        return text;
    }

    return Object.entries(dict).reduce((text, [key, val]) => text.replaceAll(`{${key}}`, val), text)
}

function ScheißeÖlGenerieren(
    { länge = 80, name = null, class_ = null, event = null }
) {
    const validSätze = Object.entries({ name, class_, event }).reduce((list, [key, val]) => val ? list : list.filter((str) => !str.includes(`{${key}}`)), Materialien.notwendig["Subjekt"]);

    durchmischen(Materialien.notwendig.Ausrufe);
    const Ausruf = Materialien.notwendig.Ausrufe[0];

    durchmischen(validSätze);
    const Subjekt = VorlageAusfüllen(validSätze[0],
        { 'name': name, 'class_': class_, 'event': event });

    const längeBleiben = länge - Länge(Ausruf, Subjekt);

    const unnotwendigSätze = Object.entries(Materialien.unnotwendig).reduce((arr, [Typ, list]) => arr.concat(list.map((Satz) => [Typ, Satz])), []);

    durchmischen(unnotwendigSätze);

    const ausgewählteSätze = unnotwendigSätze.reduce((Sätze, val) => {
        return (Länge(Sätze.map(([, Satz]) => Satz)) < längeBleiben) ? [...Sätze, val] : Sätze;
    }, []);

    const Ordung = {
        DetaillierteBeschreibung: 1,
        SchöneSätze: 2,
        Ihr: 3
    };
    ausgewählteSätze.sort((a, b) => {
        return Ordung[a] - Ordung[b];
    });

    return [...ausgewählteSätze.map(([, Satz]) => Satz), Ausruf, Subjekt]
        .join(Punkt).replaceAll("！。", "！")
        .replaceAll("？。", "？")
        .replaceAll("。。", "。")
        .replaceAll('"', '')
        .replaceAll(/^。/g, "");
}


function generieren() {
    const params = {
        name: document.getElementById("name").value,
        class_: document.getElementById("class_").value,
        event: document.getElementById("event").value,
        länge: document.getElementById("range").value
    };
    document.getElementById("文章").innerText = ScheißeÖlGenerieren(params);
}

const rangeEle = document.getElementById("range");
const valueEle = document.getElementById("value");
const handler = (evt) => {
    valueEle.innerText = evt.target.value + " 字";
};

valueEle.innerText = rangeEle.value + " 字";
rangeEle.addEventListener("change", handler);
rangeEle.addEventListener("input", handler);